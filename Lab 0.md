## Objective

In this lab, we'll complete all the pre-requisites for the Alexa Smart Home E2E Solution and generate the following parameters (needed in the following labs):

- MQTT endpoint
- Github web app respository URL
- Github access token

## Project Structure

The project repository has the following  structure

```
working [1]
|
+-- lambda [2]
|      |
|      +-- asyncUpdates [3]
|      |
|      +-- syncUpdates [4]
|      |
|      +-- smartHomeSkill [5]
|      |      
|      +-- lambdaAuthorizer [6]
|      |      
|      +-- webBackend [7]
|      |      
|      +-- thingsLayer [8]
|      
+-- thing [9]
|
|-- Key Parameters.xlsx


[1] This is the project root folder. 
[2] This is the root folder of the Lambda functions.  
[3] This lambda function takes care of sending proactive state updates to Alexa.
[4] This lambda function is the interface point for requests coming in from the SH skill lambda function. 
[5] This is the smart home skill lambda function. It receives directives from Alexa, communicates with the backend and sends responses back to Alexa.
[6] This lambda function authenticates requests sent to the lambda fucntions (a part of API gateway)
[7] This lambda function is the interface point for the requests generated by the web app. 
[8] The low level APIs used across the lambda functions to retrieve device data, access tokens and perform database operations
[9] This is the root folder for the simulated device
[10] A file to store all the parameters used in the workshop
```


## Download the Smart Home E2E Solution repository

1. Either download or clone the [alexa-smart-home-e2e-solution-workshop repository](https://github.com/alexa-samples/alexa-smart-home-e2e-solution-workshop)

   - To download, click on **Code** and select **Download ZIP**

<img width="917" alt="Screen Shot 2022-05-16 at 2 43 44 PM" src="https://user-images.githubusercontent.com/83840078/168724999-79926107-a002-496d-a5ba-fdd3ca598b40.png">

   - To clone, use the following command from the CLI, `git clone https://github.com/alexa-samples/alexa-smart-home-e2e-solution-workshop`

2. We'll use the code from this directory in the following labs.


## Sign up for an AWS account

1. Open https://portal.aws.amazon.com/billing/signup. If you already have one, then skip to the next section.
2. Follow the provided instructions


## Install AWS CLI

1.	Install AWS CLI from https://aws.amazon.com/cli/
2.	[Configure AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-config)
> Note: while configuring, select region as **us-east-1**.
3.	Open the command line and type the below command:
```
aws iot describe-endpoint --endpoint-type iot:Data-ATS
```
4. Copy the **MQTT endpoint address**. The endpoint address should look something like `xxxxxxxxxxxxx-ats.iot.us-east-1.amazonaws.com`


> Make a note of this MQTT endpoint address. For your convenience, you can use the Key Parameters.xlsx file to manage all the parameters. You can chose an application of your choice to keep a track of these parameters.


## Setup Amazon Developer Account

1. Click [here](https://www.amazon.com/ap/register?clientContext=131-2644327-8903012&openid.identity=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&siteState=clientContext%3D131-5707077-1815966%2CsourceUrl%3Dhttps%253A%252F%252Fdeveloper.amazon.com%252Fsettings%252Fconsole%252Fhome%2Csignature%3DuNzCzFV0Pom1J7jlUAmGSIfpg9Mj3D&marketPlaceId=ATVPDKIKX0DER&language=en_US&pageId=amzn_developer_portal&openid.return_to=https%3A%2F%2Fdeveloper.amazon.com%2Fsettings%2Fconsole%2Fhome&prevRID=FM0JYMJSGFZK7RMBH1E8&openid.assoc_handle=mas_dev_portal&openid.mode=checkid_setup&prepopulatedLoginId=&failedSignInCount=0&openid.claimed_id=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0) to register for an Amazon Developer account. This is dfferent from AWS developer account and is needed to create Smart Home skill. If you already have one, then skip to the next section.


## Create a Web App repository

1. Navigate to the [web app repository](https://github.com/alexa-labs/alexa-smart-home-e2e-solution-webapp)
2. Click on **Use this template** button to create a copy

<img width="813" alt="Screen Shot 2022-05-16 at 8 54 29 PM" src="https://user-images.githubusercontent.com/83840078/168725842-f9059b3b-7f20-43f5-ae57-c27c67a64ae4.png">

3. Add details for your repository and click **Create repository from template**

<img width="763" alt="Screen Shot 2022-05-16 at 8 54 58 PM" src="https://user-images.githubusercontent.com/83840078/168725881-e67cb181-32b8-4e48-add1-68f6b5b06ba8.png">

4. Once repository is created, it'll show all the files in your account

<img width="816" alt="Screen Shot 2022-05-16 at 8 55 33 PM" src="https://user-images.githubusercontent.com/83840078/168725909-a7183040-dfce-473f-91be-662262242b99.png">

5. Click on the Green color button **Code**, and click the copy button next to your GIT url. Keep a note of this URL, this will be needed in the next lab.

<img width="412" alt="Screen Shot 2022-05-16 at 8 56 05 PM" src="https://user-images.githubusercontent.com/83840078/168725945-3d137bbd-d5f5-40d1-a086-342cdbb2eda3.png">


## Generate GitHub Access Token

1. Click on your Github account image on the top right corner and then click **Settings**

<img width="192" alt="Screen Shot 2022-05-16 at 8 56 22 PM" src="https://user-images.githubusercontent.com/83840078/168725972-f8891e0f-abad-43d5-98c2-a3a31f2a17ec.png">

2. Scroll down and select **Developer settings**

<img width="303" alt="Screen Shot 2022-05-16 at 8 56 46 PM" src="https://user-images.githubusercontent.com/83840078/168726095-1f44c8f3-187e-49fd-977f-e4e2236f8803.png">

3. Click on **Personal Access Tokens** and then click on **Generate new token** button on top right

<img width="1101" alt="Screen Shot 2022-05-16 at 8 57 10 PM" src="https://user-images.githubusercontent.com/83840078/168726070-fb35a0f7-875c-475d-96c6-7b4484b2ca9e.png">

4. Enter a note in the **Note** field, then select the **repo** scope and then scroll down to click on the **Generate token** button

<img width="799" alt="Screen Shot 2022-05-16 at 8 57 32 PM" src="https://user-images.githubusercontent.com/83840078/168726050-53ca0da7-41bd-4916-8e85-4701d675cd38.png">

5. Click on copy button to copy the token

![image](https://user-images.githubusercontent.com/83840078/167213525-1d78dba9-df29-485f-a843-85db46ca2851.png)

6. Keep a note of this token. It'll be used in the next lab.


## Install Utilities

1. Install [Node.js and npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm). Once downloaded and installed check for the version.

2. Open comand prompt and navigate to the Thing directory downloaded in the earlier step

3. In the Thing directory, type the following command `npm install` to install the dependencies


## Summary & Next Step

Congratulations! You have successfully finished your Pre-requisites lab. By now, you would have created the following:

- Your Amazon AWS account
- Your Amazon Developer
- A repository for the web app
- A repo scope access token for your github repository

In the next lab, we'll set up the device, web app and the backend. 

[Lab 1: Setup Device, WebApp and Backend](Lab%201.md) 
